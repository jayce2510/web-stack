version: '3.3'

services:

  mariadb-vat-invoice:
    container_name: mariadb-vat-invoice
    image: mariadb:10.6-focal
    ports:
      - 3410:3306
    restart: always
    volumes:
      - ./vat-invoice-db:/var/lib/mysql
    environment:
      MYSQL_ROOT_PASSWORD: $MYSQL_PASS_ROOT
      MYSQL_DATABASE: $MYSQL_DB
      MYSQL_USER: $MYSQL_USER
      MYSQL_PASSWORD: $MYSQL_PASS
      TZ: Asia/Ho_Chi_Minh

  phpmyadmin-vat-invoice:
    container_name: phpmyadmin-vat-invoice
    image: phpmyadmin/phpmyadmin:latest
    restart: always
    environment:
      PMA_HOST: mariadb
      PMA_PORT: 3306
      PMA_ARBITRARY: 1
      UPLOAD_LIMIT: 1500M
      POST_MAX_SIZE: 1500M
      MAX_EXECUTION_TIME: 4000
      MAX_INPUT_VARS: 1500
      TZ: Asia/Ho_Chi_Minh
    ports:
      - 9095:80

  php-fpm-vat-invoice:
    container_name: php-fpm-vat-invoice
    image: php:7.4.3-fpm
    restart: always
    volumes:
      - /var/www/staging/vat-invoice-stg.vn.fitlg.asia:/var/www/staging/vat-invoice-stg.vn.fitlg.asia
      - ./php/www.conf:/usr/local/etc/php-fpm.d/www.conf
      - ./logs/php:/var/log/fpm-php.www.log
    environment:
      TZ: Asia/Ho_Chi_Minh

  nginx-vat-invoice:
    container_name: nginx-vat-invoice
    image: nginx:1.18.0
    ports:
      - 8085:80
    restart: always
    volumes:
      - /var/www/staging/vat-invoice-stg.vn.fitlg.asia:/var/www/staging/vat-invoice-stg.vn.fitlg.asia
      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf
      - ./logs/nginx:/var/log/nginx/
    environment:
      TZ: Asia/Ho_Chi_Minh